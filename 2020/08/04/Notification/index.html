<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/Klien.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="记往昔录今朝只待明时">
  <meta name="author" content="Klien">
  <meta name="keywords" content="安卓原生开发、python日常脚本、Developer">
  <title>Notification - Klien-m&#39;s 博客</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/androidstudio.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Klien-m's 博客</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/1920-1080/android3.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-08-04 14:34">
      2020年8月4日 下午
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      26
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
              <p class="note note-info">
                
                  本文最后更新于：1 个月前
                
              </p>
            
            <article class="markdown-body">
              <p><a href="https://developer.android.google.cn/guide/topics/ui/notifiers/notifications?hl=zh" target="_blank" rel="noopener">通知</a>是指 Android 在应用的界面之外显示的消息，旨在向用户提供提醒、来自他人的通信信息或应用中的其他实时信息。</p>
<a id="more"></a>

<h2 id="通知刨析"><a href="#通知刨析" class="headerlink" title="通知刨析"></a>通知刨析<a id="通知刨析"></a></h2><p><img src="/img/%E6%8F%92%E5%9B%BE/notification-callouts_2x.png" srcset="/img/loading.gif" alt="通知"></p>
<ol>
<li><code>setSmallIcon()</code></li>
<li>应用名称</li>
<li>时间戳：由系统提供，但可以通过 <code>setWhen()</code> 将其替换掉或者通过 <code>setShowWhen(false)</code> 将其隐藏。</li>
<li><code>setLargeIcon()</code></li>
<li><code>setContentTitle()</code></li>
<li><code>setContentText()</code></li>
</ol>
<h2 id="创建通知"><a href="#创建通知" class="headerlink" title="创建通知"></a>创建通知</h2><h3 id="添加支持库"><a href="#添加支持库" class="headerlink" title="添加支持库"></a>添加支持库</h3><div class="hljs"><pre><code class="hljs java">implementation <span class="hljs-string">"com.android.support:support-compat:28.0.0"</span></code></pre></div>

<h3 id="创建基本通知"><a href="#创建基本通知" class="headerlink" title="创建基本通知"></a>创建基本通知</h3><h4 id="设置通知内容"><a href="#设置通知内容" class="headerlink" title="设置通知内容"></a>设置通知内容</h4><ul>
<li>见上<a href="#通知刨析">通知刨析</a></li>
<li><code>setPriority()</code> 设置通知优先级。优先级确定通知在 Android 7.1 和更低版本上的干扰程度。</li>
</ul>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">var</span> builder = NotificationCompat.Builder(<span class="hljs-keyword">this</span>, CHANNEL_ID)
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle(textTitle)
        .setContentText(textContent)
        .setPriority(NotificationCompat.PRIORITY_DEFAULT)</code></pre></div>

<h4 id="创建渠道并设置重要性"><a href="#创建渠道并设置重要性" class="headerlink" title="创建渠道并设置重要性"></a>创建渠道并设置重要性</h4><p>向 <code>createNotificationChannel()</code> 传递 <code>NotificationChannel</code> 的实例在系统中注册应用的通知渠道。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createNotificationChannel</span><span class="hljs-params">()</span></span> &#123;
    <span class="hljs-comment">// Create the NotificationChannel, but only on API 26+ because</span>
    <span class="hljs-comment">// the NotificationChannel class is new and not in the support library</span>
    <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) &#123;
        <span class="hljs-keyword">val</span> name = getString(R.string.channel_name)
        <span class="hljs-keyword">val</span> descriptionText = getString(R.string.channel_description)
        <span class="hljs-keyword">val</span> importance = NotificationManager.IMPORTANCE_DEFAULT
        <span class="hljs-keyword">val</span> channel = NotificationChannel(CHANNEL_ID, name, importance).apply &#123;
            description = descriptionText
        &#125;
        <span class="hljs-comment">// Register the channel with the system</span>
        <span class="hljs-keyword">val</span> notificationManager: NotificationManager =
            getSystemService(Context.NOTIFICATION_SERVICE) <span class="hljs-keyword">as</span> NotificationManager
        notificationManager.createNotificationChannel(channel)
    &#125;
&#125;</code></pre></div>

<h4 id="设置通知的点按操作"><a href="#设置通知的点按操作" class="headerlink" title="设置通知的点按操作"></a>设置通知的点按操作</h4><p>指定通过 <code>PendingIntent</code> 对象定义的内容 Intent，并将其传递给 <code>setContentIntent()</code>。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-comment">// Create an explicit intent for an Activity in your app</span>
<span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, AlertDetails::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>).<span class="hljs-title">apply</span> </span>&#123;
    flags = Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TASK
&#125;
<span class="hljs-keyword">val</span> pendingIntent: PendingIntent = PendingIntent.getActivity(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>, intent, <span class="hljs-number">0</span>)

<span class="hljs-keyword">val</span> builder = NotificationCompat.Builder(<span class="hljs-keyword">this</span>, CHANNEL_ID)
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle(<span class="hljs-string">"My notification"</span>)
        .setContentText(<span class="hljs-string">"Hello World!"</span>)
        .setPriority(NotificationCompat.PRIORITY_DEFAULT)
        <span class="hljs-comment">// Set the intent that will fire when the user taps the notification</span>
        .setContentIntent(pendingIntent)
        .setAutoCancel(<span class="hljs-literal">true</span>) <span class="hljs-comment">// 点按通知后自动移除通知</span></code></pre></div>

<p><code>setFlags()</code> 方法可帮助保留用户在通过通知打开应用后的预期导航体验。</p>
<ul>
<li>专用于响应通知的 Activity。启动一个新任务，而不是添加到应用的现有任务和返回堆栈。</li>
<li>应用的常规应用流程中存在的 Activity。启动 Activity 时应创建返回堆栈，以便保留用户对返回和向上按钮的预期。</li>
</ul>
<h4 id="显示通知"><a href="#显示通知" class="headerlink" title="显示通知"></a>显示通知</h4><p><code>NotificationManagerCompat.notify()</code> 方法参数为：通知 ID 和 <code>NotificationCompat.Builder.build()</code>。</p>
<h3 id="创建折叠式通知"><a href="#创建折叠式通知" class="headerlink" title="创建折叠式通知"></a>创建折叠式通知</h3><ol>
<li>创建视图布局</li>
<li><code>RemoteViews remoteViews = new RemoteViews(getPackageName(), R.layout.layout_name);</code></li>
<li><code>notification.bigContentView = remoteViews;</code> <strong>or</strong> <code>notification.contentView = remoteViews;</code></li>
</ol>
<h3 id="添加操作按钮"><a href="#添加操作按钮" class="headerlink" title="添加操作按钮"></a>添加操作按钮</h3><p>将 <code>addAction()</code> 传递给 <code>PendingIntent</code> 方法。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> snoozeIntent = Intent(<span class="hljs-keyword">this</span>, MyBroadcastReceiver::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>).<span class="hljs-title">apply</span> </span>&#123;
    action = ACTION_SNOOZE
    putExtra(EXTRA_NOTIFICATION_ID, <span class="hljs-number">0</span>)
&#125;
<span class="hljs-keyword">val</span> snoozePendingIntent: PendingIntent =
    PendingIntent.getBroadcast(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>, snoozeIntent, <span class="hljs-number">0</span>)
<span class="hljs-keyword">val</span> builder = NotificationCompat.Builder(<span class="hljs-keyword">this</span>, CHANNEL_ID)
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle(<span class="hljs-string">"My notification"</span>)
        .setContentText(<span class="hljs-string">"Hello World!"</span>)
        .setPriority(NotificationCompat.PRIORITY_DEFAULT)
        .setContentIntent(pendingIntent)
        .addAction(R.drawable.ic_snooze, getString(R.string.snooze),
                snoozePendingIntent)</code></pre></div>

<h3 id="添加直接回复操作"><a href="#添加直接回复操作" class="headerlink" title="添加直接回复操作"></a><a href="https://developer.android.google.cn/training/notify-user/build-notification?hl=zh#reply-action" target="_blank" rel="noopener">添加直接回复操作</a></h3><h3 id="添加进度条"><a href="#添加进度条" class="headerlink" title="添加进度条"></a>添加进度条</h3><p>如果可以估算操作在任何时间点的完成进度，可以通过调用 <code>setProgress(mamx, progress, false)</code>。移除进度条 <code>setProgress(0, 0, false)</code>。</p>
<p>如果需要显示不确定性进度条，可以调用 <code>setProgress(0, 0, true)</code>。移除进度条同样使用 <code>setProgress(0, 0, false)</code>。</p>
<h3 id="设置系统范围的类别"><a href="#设置系统范围的类别" class="headerlink" title="设置系统范围的类别"></a>设置系统范围的类别</h3><ul>
<li><code>setCategory()</code><br><code>CATEGORY_ALARM</code>、<code>CATEGORY_REMINDER</code>、<code>CATEGORY_EVENT</code>、<code>CATEGORY_CALL</code></li>
</ul>
<h3 id="显示紧急信息"><a href="#显示紧急信息" class="headerlink" title="显示紧急信息"></a>显示紧急信息</h3><p>如果应用的目标平台是 Android 10（API29）或更高版本，必须在应用清单文件中请求 <code>USE_FULL_SCREEN_INTENT</code> 权限，以便系统启动与时效性通知关联的全屏 Activity。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> fullScreenIntent = Intent(<span class="hljs-keyword">this</span>, ImportantActivity::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>)</span>
<span class="hljs-keyword">val</span> fullScreenPendingIntent = PendingIntent.getActivity(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>,
    fullScreenIntent, PendingIntent.FLAG_UPDATE_CURRENT)

<span class="hljs-keyword">var</span> builder = NotificationCompat.Builder(<span class="hljs-keyword">this</span>, CHANNEL_ID)
        .setSmallIcon(R.drawable.notification_icon)
        .setContentTitle(<span class="hljs-string">"My notification"</span>)
        .setContentText(<span class="hljs-string">"Hello World!"</span>)
        .setPriority(NotificationCompat.PRIORITY_DEFAULT)
        .setFullScreenIntent(fullScreenPendingIntent, <span class="hljs-literal">true</span>)</code></pre></div>

<h3 id="设置锁定屏幕的公开范围"><a href="#设置锁定屏幕的公开范围" class="headerlink" title="设置锁定屏幕的公开范围"></a>设置锁定屏幕的公开范围</h3><p><code>setVisibility()</code></p>
<ul>
<li><code>VISIBILITY_PUBLIC</code> 显示通知的完整内容。</li>
<li><code>VISIBILITY_SECRET</code> 不在锁定屏幕上显示该通知的任何部分。</li>
<li><code>VISIBILITY_PRIVATE</code> 显示基本信息，但隐藏通知的完整内容。当设置为此级别时，可以通过 <code>setPublicVersion()</code> 方法提供通知内容的备用版本。</li>
</ul>
<h3 id="更新和移除通知"><a href="#更新和移除通知" class="headerlink" title="更新和移除通知"></a>更新和移除通知</h3><ul>
<li><code>NotificationManagerCompat.notify()</code> 更新通知，传入参数为之前使用的具有同一 ID 的通知，如果之前的通知已被关闭，系统会创建一个新通知。调用 <code>setOnlyAlertOnce()</code> 方法会使得通知只在首次出现时打断用户。</li>
<li><code>cancel(ID)</code>、<code>cancelAll()</code>、<code>setTimeoutAfter()</code></li>
</ul>
<h2 id="创建展开式通知"><a href="#创建展开式通知" class="headerlink" title="创建展开式通知"></a>创建展开式通知</h2><ul>
<li><p><code>NotificationCompat.BigPictureStyle</code> 添加大图片，如需使该图片仅在通知收起时显示为缩略图，调用 <code>setLargeIcon()</code> 并向其传递图片，同时调用 <code>BigPictureStyle.bigLargeIcon(null)</code>，这样大图标就会在通知展开时消失。</p>
</li>
<li><p><code>NotificationCompat.BigTextStyle</code> 添加一大段文本</p>
</li>
<li><p><code>NotificationCOmpat.InboxStyle</code> 创建收件箱样式的通知。如需添加新行，最多可调用 <code>addLine()</code> 6 次，若超过 6 次，仅显示前 6 行。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">var</span> notification = NotificationCompat.Builder(context, CHANNEL_ID)
        .setSmallIcon(R.drawable.new_mail)
        .setContentTitle(<span class="hljs-string">"5 New mails from "</span> + sender.toString())
        .setContentText(subject)
        .setLargeIcon(aBitmap)
        .setStyle(NotificationCompat.InboxStyle()
                .addLine(messageSnippet1)
                .addLine(messageSnippet2))
        .build()</code></pre></div>
</li>
<li><p><a href="https://developer.android.google.cn/training/notify-user/expanded?hl=zh#message-style" target="_blank" rel="noopener">在通知中显示对话</a></p>
</li>
<li><p><a href="https://developer.android.google.cn/training/notify-user/expanded?hl=zh#media-style" target="_blank" rel="noopener">使用媒体控件创建通知</a></p>
</li>
</ul>
<h2 id="从通知启动-Activity"><a href="#从通知启动-Activity" class="headerlink" title="从通知启动 Activity"></a>从通知启动 Activity</h2><h3 id="设置常规-Activity-PendingIntent"><a href="#设置常规-Activity-PendingIntent" class="headerlink" title="设置常规 Activity PendingIntent"></a>设置常规 Activity PendingIntent</h3><p>使用 <code>TaskStackBuilder</code> 设置 <code>PendingIntent</code>。</p>
<ol>
<li><p><strong>定义应用的 Activity 层次结构</strong><br>通过应用清单文件为每个 <code>&lt;activity&gt;</code> 元素添加 <code>android:parentActivityName</code> 属性来定义 Activity 的自然层次结构。</p>
</li>
<li><p><strong>构建包含返回堆栈的 PendingIntent</strong><br>创建 <code>TaskStackBuilder</code> 的实例并调用 <code>addNextIntentWithParentStack()</code>，向其传递需要启动的 Activity 的 <code>Intent</code>。只要为每个 Activity 定义了父 Activity，就可以调用 <code>getPendingIntent()</code> 来接收包含整个返回堆栈的 <code>PendingIntent</code>。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-comment">// Create an Intent for the activity you want to start</span>
<span class="hljs-keyword">val</span> resultIntent = Intent(<span class="hljs-keyword">this</span>, ResultActivity::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>)</span>
<span class="hljs-comment">// Create the TaskStackBuilder</span>
<span class="hljs-keyword">val</span> resultPendingIntent: PendingIntent? = TaskStackBuilder.create(<span class="hljs-keyword">this</span>).run &#123;
    <span class="hljs-comment">// Add the intent, which inflates the back stack</span>
    addNextIntentWithParentStack(resultIntent)
    <span class="hljs-comment">// Get the PendingIntent containing the entire back stack</span>
    getPendingIntent(<span class="hljs-number">0</span>, PendingIntent.FLAG_UPDATE_CURRENT)
&#125;</code></pre></div>

</li>
</ol>
<h3 id="设置特殊-Activity-PendingIntent"><a href="#设置特殊-Activity-PendingIntent" class="headerlink" title="设置特殊 Activity PendingIntent"></a>设置特殊 Activity PendingIntent</h3><ol>
<li><p>在清单中将以下属性添加到 <code>&lt;activity&gt;</code> 元素。</p>
<ul>
<li><code>android:taskAffinity=&quot;&quot;</code><br>结合 <code>FLAG_ACTIVITY_NEW_TASK</code> 标记使用，将此属性设置为空，可确保这类 Activity 不会进入应用的默认任务。</li>
<li><code>android:excludeFromRecents=&quot;true&quot;</code><br>用于从“最近”中排除新任务，以免用户意外返回它。</li>
</ul>
</li>
<li><p>构建并发出通知<br>a. 创建可启动 <code>Activity</code> 的 <code>Intent</code>。<br>b. 通过使用 <code>FLAG_ACTIVITY_NEW_TASK</code> 和 <code>FLAG_ACTIVITY_CLEAR_TASK</code> 标记调用 <code>setFlags()</code>，将 <code>Activity</code> 设置为在新的空任务中启动。<br>c. 通过调用 <code>getActivity()</code> 创建 <code>PendingIntent</code></p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> notifyIntent = Intent(<span class="hljs-keyword">this</span>, ResultActivity::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>).<span class="hljs-title">apply</span> </span>&#123;
    flags = Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_CLEAR_TASK
&#125;
<span class="hljs-keyword">val</span> notifyPendingIntent = PendingIntent.getActivity(
        <span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>, notifyIntent, PendingIntent.FLAG_UPDATE_CURRENT
)</code></pre></div>
</li>
<li><p>将 <code>PendingIntent</code> 传递到通知中。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> builder = NotificationCompat.Builder(<span class="hljs-keyword">this</span>, CHANNEL_ID).apply &#123;
    setContentIntent(notifyPendingIntent)
    ...
&#125;
with(NotificationManagerCompat.from(<span class="hljs-keyword">this</span>)) &#123;
    notify(NOTIFICATION_ID, builder.build())
&#125;</code></pre></div>

</li>
</ol>
<h2 id="创建一组通知"><a href="#创建一组通知" class="headerlink" title="创建一组通知"></a>创建一组通知</h2><ul>
<li>调用 <code>setGroup()</code> 方法，传入参数为一个唯一标识符字符串。</li>
<li><code>setSortKey()</code> 更改通知顺序，默认根据发布时间排序</li>
<li><code>setGroupAlertBehavior()</code> 通知组的提醒应由其他通知处理。如果只希望通知组摘要发出提醒，那么通知组中的所有子级都应具有通知组提醒行为 <code>GROUP_ALERT_SUMMARY</code>。其他选项包括 <code>GROUP_ALERT_ALL</code> 和 <code>GROUP_ALERT_CHILDREN</code>。</li>
<li><code>setGroupSummary(true)</code> 设置通知组摘要。</li>
</ul>
<h2 id="创建和管理通知渠道"><a href="#创建和管理通知渠道" class="headerlink" title="创建和管理通知渠道"></a>创建和管理通知渠道</h2><p>从 Android 8.0（API 级别 26）开始，所有通知都必须分配到相应的渠道。</p>
<h3 id="创建通知渠道"><a href="#创建通知渠道" class="headerlink" title="创建通知渠道"></a>创建通知渠道</h3><ol>
<li>构建一个具有唯一渠道 ID、用户可见名称和重要性级别的 <code>NotificationChannel</code> 对象。</li>
<li>（可选）使用 <code>setDescription()</code> 指定用户在系统设置中看到的说明。</li>
<li>注册通知渠道，方法是将该渠道传递给 <code>createNotificationChannel()</code>。</li>
</ol>
<h4 id="设置重要性级别"><a href="#设置重要性级别" class="headerlink" title="设置重要性级别"></a>设置重要性级别</h4><p>渠道重要性会影响在渠道中发布的所有通知的干扰级别，包括从 <code>IMPORTANCE_NONE(0)</code> 到 <code>IMPORTANCE_HIGH(4)</code> 5 个重要性级别。</p>
<h3 id="读取通知渠道设置"><a href="#读取通知渠道设置" class="headerlink" title="读取通知渠道设置"></a>读取通知渠道设置</h3><ol>
<li>通过调用 <code>getNotificationChannel()</code> 或 <code>getNotificationChannels()</code> 来获取 <code>NotificationChannel</code> 对象。</li>
<li>查询特定的渠道设置，例如 <code>getVibrationPattern()</code>、<code>getSound()</code> 和 <code>getImportance()</code>。</li>
</ol>
<h3 id="打开通知渠道设置"><a href="#打开通知渠道设置" class="headerlink" title="打开通知渠道设置"></a>打开通知渠道设置</h3><p>创建通知渠道后，无法以编程方式更改通知渠道的视觉和听觉行为，只有用户可以通过系统设置更改渠道行为。为了让用户轻松访问这些通知设置，应在应用的设置界面中添加一个用于打开这些系统设置的项。</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> intent = Intent(Settings.ACTION_CHANNEL_NOTIFICATION_SETTINGS).apply &#123;
    putExtra(Settings.EXTRA_APP_PACKAGE, packageName)
    putExtra(Settings.EXTRA_CHANNEL_ID, myNotificationChannel.getId())
&#125;
startActivity(intent)</code></pre></div>

<h3 id="删除通知渠道"><a href="#删除通知渠道" class="headerlink" title="删除通知渠道"></a>删除通知渠道</h3><p>可以通过调用 <code>deleteNotificationChannel()</code> 删除通知渠道。</p>
<h3 id="创建通知渠道分组"><a href="#创建通知渠道分组" class="headerlink" title="创建通知渠道分组"></a>创建通知渠道分组</h3><p>创建新渠道分组</p>
<div class="hljs"><pre><code class="hljs kotlin"><span class="hljs-comment">// The id of the group.</span>
<span class="hljs-keyword">val</span> groupId = <span class="hljs-string">"my_group_01"</span>
<span class="hljs-comment">// The user-visible name of the group.</span>
<span class="hljs-keyword">val</span> groupName = getString(R.string.group_name)
<span class="hljs-keyword">val</span> notificationManager = getSystemService(Context.NOTIFICATION_SERVICE) <span class="hljs-keyword">as</span> NotificationManager
notificationManager.createNotificationChannelGroup(NotificationChannelGroup(groupId, groupName))</code></pre></div>

<p>创建分组后，可以调用 <code>setGroup()</code> 将 <code>NotificationChannel</code> 对象与该分组相关联。</p>
<h2 id="修改通知标志"><a href="#修改通知标志" class="headerlink" title="修改通知标志"></a><a href="https://developer.android.google.cn/training/notify-user/badges?hl=zh" target="_blank" rel="noopener">修改通知标志</a></h2><h2 id="创建自定义通知"><a href="#创建自定义通知" class="headerlink" title="创建自定义通知"></a><a href="https://developer.android.google.cn/training/notify-user/custom-notification?hl=zh" target="_blank" rel="noopener">创建自定义通知</a></h2>
            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AE%89%E5%8D%93/">安卓</a>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AE%89%E5%8D%93/%E7%BB%84%E4%BB%B6/">组件</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/08/05/%E3%80%8AAndroid%E8%BF%9B%E9%98%B6%E4%B9%8B%E5%85%89%E3%80%8B/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">《Android进阶之光》</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/08/02/Android%E4%B8%AD%E7%9A%84%E5%8D%95%E4%BD%8D/">
                        <span class="hidden-mobile">Android中的单位</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;
  目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <!-- <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div> -->
    
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Notification&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
